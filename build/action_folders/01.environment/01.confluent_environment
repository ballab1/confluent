#!/bin/bash

declare -ar env_confluent=(
    'JMX_PORT=${JMX_PORT:-7203}'

    "CONFLUENT_VERSION=${CONFLUENT_VERSION:?}"
    "SCALA_DISTRO=${SCALA_DISTRO:?}"

    'KAFKA_ADVERTIZED_HOSTNAME=${KAFKA_ADVERTIZED_HOSTNAME:-localhost}'
    'KAFKA_BROKER_ID=${KAFKA_BROKER_ID:-0}'
    'KAFKA_USER_NAME=${KAFKA_USER_NAME:-kafka}'
    'KAFKA_UID=${KAFKA_UID:-$(confluent.UID "$KAFKA_USER_NAME")}'
    'KAFKA_GROUP=${KAFKA_GROUP:-kafka}'
    'KAFKA_GID=${KAFKA_GID:-$(confluent.GID "$KAFKA_GROUP")}'
    'KAFKA_PARTITIONS=${KAFKA_PARTITIONS:-1}'
    'KAFKA_PORT=${KAFKA_PORT:-9092}'

    'ZOOKEEPER_MY_ID=${ZOOKEEPER_MY_ID:-1}'
    'ZOOKEEPER_HOST=${ZOOKEEPER_HOST:-localhost}'
    'ZOOKEEPER_PORT=${ZOOKEEPER_PORT:-2181}'
    'ZOOKEEPER_TICK_TIME=${ZOOKEEPER_TICK_TIME:-2000}'
    'ZOOKEEPER_INIT_LIMIT=${ZOOKEEPER_INIT_LIMIT:-5}'
    'ZOOKEEPER_SYNC_LIMIT=${ZOOKEEPER_SYNC_LIMIT:-2}'
    'ZOOKEEPER_TIMEOUT=${ZOOKEEPER_TIMEOUT:-6000}'

    'KAFKA_USER_DIR="${KAFKA_USER_DIR:-/usr/local/confluent}"'
    'KAFKA_CONF_DIR="${KAFKA_CONF_DIR:-${KAFKA_USER_DIR}/etc/kafka}"'
    'KAFKA_LOG_DIRS="${KAFKA_LOG_DIRS:-${KAFKA_USER_DIR}/logs}"'
    'ZOOKEEPER_USER_DIR="${KAFKA_USER_DIR:-/usr/local/confluent}"'
    'ZOOKEEPER_CONF_DIR="${ZOOKEEPER_CONF_DIR:-${ZOOKEEPER_USER_DIR}/etc/kafka}"'
    'ZOOKEEPER_DATA_DIR="${ZOOKEEPER_DATA_DIR:-${ZOOKEEPER_USER_DIR}/data}"'
    'ZOOKEEPER_LOG_DIR="${ZOOKEEPER_LOG_DIR:-${ZOOKEEPER_USER_DIR}/logs}"'

    'WORKDIR="${KAFKA_USER_DIR}"'
    'USER=${KAFKA_UID}'
)

#remove WORKDIR so it comes after KAFKA_USER_DIR
crf.removeFromRuntimeEnvironment 'WORKDIR'  
crf.removeFromRuntimeEnvironment 'USER'  
crf.updateRuntimeEnvironment "${env_confluent[@]}" 


