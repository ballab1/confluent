#!/bin/bash

declare -ar env_confluent=(
    'JMX_PORT=${JMX_PORT:-7203}'

    "CONFLUENT_VERSION=${CONFLUENT_VERSION:?}"
    "SCALA_DISTRO=${SCALA_DISTRO:?}"

    'KAFKA_GROUP=${KAFKA_GROUP:-kafka}'
    'KAFKA_GID=${KAFKA_GID:-$(confluent.GID "$KAFKA_GROUP")}'
    'KAFKA_USER_NAME=${KAFKA_USER_NAME:-kafka}'
    'KAFKA_UID=${KAFKA_UID:-$(confluent.UID "$KAFKA_USER_NAME")}'


    'KAFKA_USER_DIR="${KAFKA_USER_DIR:-/usr/local/confluent}"'
    'KAFKA_CONF_DIR="${KAFKA_CONF_DIR:-${KAFKA_USER_DIR}/etc/kafka}"'
    'KAFKA_LOG_DIRS="${KAFKA_LOG_DIRS:-${KAFKA_USER_DIR}/logs}"'
    'KAFKA_ADVERTIZED_HOSTNAME=${KAFKA_ADVERTIZED_HOSTNAME:-localhost}'
    'KAFKA_PARTITIONS=${KAFKA_PARTITIONS:-1}'
    'KAFKA_PORT=${KAFKA_PORT:-9092}'


    'ZOOKEEPER_USER_DIR="${KAFKA_USER_DIR:-/usr/local/confluent}"'
    'ZOOKEEPER_CONFDIR="${ZOOKEEPER_CONFDIR:-${ZOOKEEPER_USER_DIR}/etc/kafka}"'
    'ZOOKEEPER_DATADIR="${ZOOKEEPER_DATADIR:-${ZOOKEEPER_USER_DIR}/data}"'
    'ZOOKEEPER_DATALOGDIR="${ZOOKEEPER_DATALOGDIR:-${ZOOKEEPER_USER_DIR}/logs}"'
    'ZOOKEEPER_CLIENTPORT=${ZOOKEEPER_CLIENTPORT:-2181}'
    'ZOOKEEPER_HOST=${ZOOKEEPER_HOST:-localhost}'
    'ZOOKEEPER_INITLIMIT=${ZOOKEEPER_INITLIMIT:-5}'
    'ZOOKEEPER_SYNCLIMIT=${ZOOKEEPER_SYNCLIMIT:-2}'
    'ZOOKEEPER_TICKTIME=${ZOOKEEPER_TICKTIME:-2000}'
    'ZOOKEEPER_TIMEOUT=${ZOOKEEPER_TIMEOUT:-6000}'

    'WORKDIR="${KAFKA_USER_DIR}"'
    'USER=${KAFKA_UID}'
)

#remove WORKDIR so it comes after KAFKA_USER_DIR
crf.removeFromRuntimeEnvironment 'WORKDIR'  
crf.removeFromRuntimeEnvironment 'USER'  
crf.updateRuntimeEnvironment "${env_confluent[@]}" 


